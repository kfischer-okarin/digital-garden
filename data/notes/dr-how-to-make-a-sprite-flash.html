<h1 id="make-a-sprite-flash">Make a Sprite flash<a aria-hidden="true" class="anchor-heading icon-link" href="#make-a-sprite-flash"></a></h1>
<p><img src="/digital-garden/assets/images/dr-flash-sprite-before.png" style="height:256px;">       
<img src="/digital-garden/assets/images/dr-flash-sprite-after.png" style="height:256px;"></p>
<p>You achieve a flashing effect by drawing a colored solid over your sprite while using additive blending
(<code>blendmode_enum</code> 2). The background behind the sprite must be transparent though when you render the white rectangle
on top - so you need to render it first on a separate render target otherwise the rectangle would also blend with your
stage etc.</p>
<pre class="language-rb"><code class="language-rb"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">white_sprite</span></span><span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> sprite<span class="token punctuation">,</span> render_target_name<span class="token punctuation">)</span>
  <span class="token comment"># Prepare render target in sprite size</span>
  render_target <span class="token operator">=</span> outputs<span class="token punctuation">[</span>render_target_name<span class="token punctuation">]</span>
  render_target<span class="token punctuation">.</span>width <span class="token operator">=</span> sprite<span class="token punctuation">[</span><span class="token symbol">:w</span><span class="token punctuation">]</span>
  render_target<span class="token punctuation">.</span>height <span class="token operator">=</span> sprite<span class="token punctuation">[</span><span class="token symbol">:h</span><span class="token punctuation">]</span>

  <span class="token comment"># Render sprite at bottom left of render target</span>
  render_target<span class="token punctuation">.</span>primitives <span class="token operator">&#x3C;&#x3C;</span> sprite<span class="token punctuation">.</span>merge<span class="token punctuation">(</span><span class="token symbol">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token symbol">y</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token comment"># Additive overlay with white rectangle to create a white sprite</span>
  render_target<span class="token punctuation">.</span>primitives <span class="token operator">&#x3C;&#x3C;</span> sprite<span class="token punctuation">.</span>to_solid<span class="token punctuation">(</span><span class="token symbol">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token symbol">y</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token symbol">r</span><span class="token operator">:</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token symbol">g</span><span class="token operator">:</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token symbol">blendmode_enum</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">)</span>

  <span class="token comment"># Return render target as sprite</span>
  <span class="token punctuation">{</span> <span class="token symbol">x</span><span class="token operator">:</span> sprite<span class="token punctuation">[</span><span class="token symbol">:x</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token symbol">y</span><span class="token operator">:</span> sprite<span class="token punctuation">[</span><span class="token symbol">:y</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token symbol">w</span><span class="token operator">:</span> sprite<span class="token punctuation">[</span><span class="token symbol">:w</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token symbol">h</span><span class="token operator">:</span> sprite<span class="token punctuation">[</span><span class="token symbol">:h</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token symbol">path</span><span class="token operator">:</span> render_target_name <span class="token punctuation">}</span><span class="token punctuation">.</span>sprite<span class="token operator">!</span>
<span class="token keyword">end</span>

sprite <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token symbol">x</span><span class="token operator">:</span> player<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token symbol">y</span><span class="token operator">:</span> player<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token symbol">w</span><span class="token operator">:</span> <span class="token number">16</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">h</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token symbol">path</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'player.png'</span></span> <span class="token punctuation">}</span><span class="token punctuation">.</span>sprite<span class="token operator">!</span>
args<span class="token punctuation">.</span>outputs<span class="token punctuation">.</span>primitives <span class="token operator">&#x3C;&#x3C;</span> white_sprite<span class="token punctuation">(</span>args<span class="token punctuation">.</span>outputs<span class="token punctuation">,</span> sprite<span class="token punctuation">,</span> <span class="token symbol">:flashing_player</span><span class="token punctuation">)</span>
</code></pre>